resource (?t) list_of:list(?t)


def get_default(in:?i, ?out:?i) use !list_of(?i) {
    if { [?val | ?list_of ] = list_of ::
        ?out = val
       | otherwise :: 
        ?out = in
       } 
}

def foo(!ls:list(?i), val:?i, ?out:?i) use !io {
    ?list_of = ls
    use list_of(?i) in {
        !get_default(val, ?out)
        ?ls = list_of
    }
}

!foo([1.0,2.0], 3.0, ?f)
!foo([], 1, ?i)

!println(f)
!println(i)

?ls = ["a", "b"]
?list_of = ls
use list_of(string) in {
    !get_default("default", ?out)
    ?ls = list_of
}

!println(out)
!println(length(ls))
